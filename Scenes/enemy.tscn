[gd_scene load_steps=16 format=3 uid="uid://c3r8kgek20uot"]

[ext_resource type="PackedScene" uid="uid://dj4bns2rylix3" path="res://Scenes/character.tscn" id="1_afpow"]
[ext_resource type="Script" uid="uid://ypvnx5slxopf" path="res://Scripts/enemy.gd" id="2_287tu"]
[ext_resource type="Shader" uid="uid://d1bqc03acixfi" path="res://character.gdshader" id="2_0830c"]
[ext_resource type="PackedScene" uid="uid://be7o4g8eqag73" path="res://Scenes/AreaDamage.tscn" id="4_287tu"]
[ext_resource type="PackedScene" uid="uid://cfx0dwkmulm7a" path="res://Scenes/enemy_model.tscn" id="5_0830c"]
[ext_resource type="Shader" uid="uid://dsblxcqp1g0km" path="res://Scenes/get_normal.gdshader" id="6_ghaa6"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ghaa6"]
resource_local_to_scene = true
shader = ExtResource("2_0830c")
shader_parameter/flash_color = Color(1, 0, 0, 1)
shader_parameter/flash_value = 0.0

[sub_resource type="LabelSettings" id="LabelSettings_287tu"]
font_size = 30
outline_size = 7
outline_color = Color(0, 0, 0, 1)

[sub_resource type="Gradient" id="Gradient_ghaa6"]
colors = PackedColorArray(1, 1, 1, 1, 0, 0, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_1dp5w"]
gradient = SubResource("Gradient_ghaa6")
fill = 1
fill_from = Vector2(0.4957265, 0.508547)
fill_to = Vector2(0.491453, 1)

[sub_resource type="ViewportTexture" id="ViewportTexture_ghaa6"]
viewport_path = NodePath("SubViewportContainer/SubViewport")

[sub_resource type="ViewportTexture" id="ViewportTexture_1dp5w"]
viewport_path = NodePath("SubViewportContainer/Normal")

[sub_resource type="CanvasTexture" id="CanvasTexture_auwsv"]
resource_local_to_scene = true
diffuse_texture = SubResource("ViewportTexture_ghaa6")
normal_texture = SubResource("ViewportTexture_1dp5w")

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_287tu"]
resource_local_to_scene = true
polygon = PackedVector2Array(54, -166, -47, -166, -116, -99, -44, -40, 60, -41, 114, -104)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_1dp5w"]
render_priority = 0
shader = ExtResource("6_ghaa6")
shader_parameter/WorldSpace = false
shader_parameter/RemapRange = true

[node name="Enemy" instance=ExtResource("1_afpow")]
material = SubResource("ShaderMaterial_ghaa6")
collision_layer = 10
collision_mask = 9
script = ExtResource("2_287tu")
speed = 100.0
damage = 20.0

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="." index="4"]

[node name="AreaDamage" parent="." index="7" instance=ExtResource("4_287tu")]
collision_layer = 4
collision_mask = 1

[node name="LevelLabel" type="Label" parent="." index="8"]
offset_left = -132.0
offset_top = -263.0
offset_right = -80.0
offset_bottom = -212.0
text = "1"
label_settings = SubResource("LabelSettings_287tu")
horizontal_alignment = 1
vertical_alignment = 1
autowrap_mode = 2

[node name="PointLight2D" type="PointLight2D" parent="." index="9"]
visible = false
position = Vector2(-112, -234)
texture = SubResource("GradientTexture2D_1dp5w")
texture_scale = 5.76
height = 91.0

[node name="3DProjection" parent="." index="11"]
texture = SubResource("CanvasTexture_auwsv")

[node name="LightOccluder2D" parent="." index="12"]
occluder = SubResource("OccluderPolygon2D_287tu")

[node name="SubViewportContainer" type="SubViewportContainer" parent="." index="13"]
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = 1200.0
offset_bottom = 600.0
grow_horizontal = 2
grow_vertical = 2
scale = Vector2(2, 2)
stretch = true

[node name="SubViewport" type="SubViewport" parent="SubViewportContainer" index="0"]
transparent_bg = true
handle_input_locally = false
size = Vector2i(1200, 600)

[node name="Model" parent="SubViewportContainer/SubViewport" index="0" instance=ExtResource("5_0830c")]

[node name="CamHolder" type="Node3D" parent="SubViewportContainer/SubViewport/Model" index="8"]

[node name="Camera3D" type="Camera3D" parent="SubViewportContainer/SubViewport/Model/CamHolder" index="0"]
transform = Transform3D(0.9999998, 0, 0, 0, 0.8660255, 0.5, 0, -0.50000006, 0.8660254, 0, 3.725, 4.075)
projection = 1
current = true
size = 10.0

[node name="Normal" type="SubViewport" parent="SubViewportContainer" index="1"]
transparent_bg = true
handle_input_locally = false
size = Vector2i(1200, 600)

[node name="Model" parent="SubViewportContainer/Normal" index="0" instance=ExtResource("5_0830c")]

[node name="Physical Bone upperspine" parent="SubViewportContainer/Normal/Model/robot/Armature/Skeleton3D/BoneSim" index="2"]
transform = Transform3D(-0.051073737, 0.66195047, 0.74780554, -0.0049078916, 0.7486073, -0.6629955, -0.99868286, -0.037531808, -0.034985393, -0.65964556, 1.2080488, 0.5229193)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.109476e-07, 2.2230204e-05, 0.8559603)
body_offset = Transform3D(-0.056971814, 0.6872862, 0.7241496, -3.0733645e-08, 0.7253275, -0.68840414, -0.99837595, -0.039219655, -0.04132318, -0.61985856, 0.58923054, 0.03537249)

[node name="Physical Bone upperarm_L" parent="SubViewportContainer/Normal/Model/robot/Armature/Skeleton3D/BoneSim" index="3"]
transform = Transform3D(-0.5520887, 0.06663262, 0.8311187, 0.81888497, -0.14427465, 0.5555289, 0.15692572, 0.9872917, 0.025087947, -1.9616526, 1.3329978, 0.53369224)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.0743864e-05, -0.00082040386, 0.79646987)
body_offset = Transform3D(1.0000006, -7.003546e-07, -7.5032003e-06, -7.491326e-06, 0.001032332, -0.99999976, 6.7055225e-07, 0.9999995, 0.0010322947, -4.7683716e-06, 0.7964705, -1.7881393e-06)

[node name="Physical Bone forearm_L" parent="SubViewportContainer/Normal/Model/robot/Armature/Skeleton3D/BoneSim" index="4"]
transform = Transform3D(-0.65370476, -0.030368228, 0.7561401, 0.7556177, -0.08082643, 0.650007, 0.04137655, 0.99626553, 0.075783394, -3.2672455, 0.33707857, 0.45001158)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.6986081e-07, -6.709339e-07, 0.8512808)
body_offset = Transform3D(1.0000006, 1.899898e-07, 1.9953586e-07, 2.1723099e-07, 3.2782555e-07, -1.0000005, -1.6018748e-07, 1.0000001, 2.9802322e-07, 0, 0.8512812, 4.172325e-07)

[node name="Physical Bone upperarm_R" parent="SubViewportContainer/Normal/Model/robot/Armature/Skeleton3D/BoneSim" index="5"]
transform = Transform3D(-0.576681, 0.1424882, -0.8044477, -0.80430686, 0.07367269, 0.5896294, 0.14328104, 0.98705095, 0.072118595, 1.9087632, 1.3205032, 0.5130191)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.6215612e-06, -1.659406e-06, 0.7965)
body_offset = Transform3D(1.0000005, -7.4505806e-07, 2.9802322e-07, 9.9651515e-08, -6.482005e-07, -1.0000002, 6.854534e-07, 1.0000002, -6.854534e-07, 2.3841858e-06, 0.7965002, 2.2053719e-06)

[node name="Physical Bone thigh_L" parent="SubViewportContainer/Normal/Model/robot/Armature/Skeleton3D/BoneSim" index="7"]
transform = Transform3D(-0.97702116, -0.21182296, 0.023679035, 0.0063151, 0.082277626, 0.9965895, -0.21304877, 0.9738385, -0.079049304, -0.48420924, -1.7575803, 0.4531784)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6.9409964e-07, -4.398339e-06, 0.77374446)
body_offset = Transform3D(1, 2.3841858e-07, 1.1175871e-08, -7.450581e-09, -8.195639e-08, -1.0000005, -2.3841858e-07, 1.0000002, -2.0861626e-07, 6.854534e-07, 0.7737448, 4.5597553e-06)

[node name="Physical Bone lowerleg_L" parent="SubViewportContainer/Normal/Model/robot/Armature/Skeleton3D/BoneSim" index="8"]
transform = Transform3D(-0.99574935, -0.08673455, -0.030992042, -0.027493576, -0.04124354, 0.99877083, -0.08790617, 0.99537736, 0.038683586, -0.47435886, -3.4366362, 0.47918326)
body_offset = Transform3D(0.9917245, -0.12822825, -0.006364025, 1.0765507e-06, 0.049577724, -0.9987706, 0.12838608, 0.99050486, 0.04916743, 0.0057888925, 0.90802294, -0.044678994)

[node name="Physical Bone lowerleg_R" parent="SubViewportContainer/Normal/Model/robot/Armature/Skeleton3D/BoneSim" index="10"]
transform = Transform3D(-0.75898236, -0.6510944, 0.00468351, 0.004950243, 0.0014226829, 0.99998677, -0.6510924, 0.7589955, 0.0021432838, 0.51586145, -3.4615774, 0.51933056)
joint_offset = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.317146e-06, 9.750947e-07, 0.9387756)
body_offset = Transform3D(0.6120669, 0.7906978, 0.013091853, -1.5995465e-06, 0.016556326, -0.99986327, -0.7908061, 0.61198306, 0.010134752, -0.012293726, 0.93864733, -0.009511441)

[node name="CamHolder" type="Node3D" parent="SubViewportContainer/Normal/Model" index="8"]

[node name="Camera3D" type="Camera3D" parent="SubViewportContainer/Normal/Model/CamHolder" index="0"]
transform = Transform3D(0.9999998, 0, 0, 0, 0.8660255, 0.5, 0, -0.50000006, 0.8660254, 0, 3.725, 4.075)
projection = 1
current = true
size = 10.0

[node name="MeshInstance3D" parent="SubViewportContainer/Normal/Model" index="9"]
material_override = SubResource("ShaderMaterial_1dp5w")

[node name="CanvasModulate" type="CanvasModulate" parent="." index="14"]
visible = false
color = Color(0, 0, 0, 1)

[editable path="SubViewportContainer/Normal/Model"]
[editable path="SubViewportContainer/Normal/Model/robot"]
